# tonejs-mml-to-json

**MML to Tone.js JSON Sequencer Format Converter**

<p align="left">
  <a href="README.ja.md"><img src="https://img.shields.io/badge/ðŸ‡¯ðŸ‡µ-Japanese-red.svg" alt="Japanese"></a>
  <a href="README.md"><img src="https://img.shields.io/badge/ðŸ‡ºðŸ‡¸-English-blue.svg" alt="English"></a>
  <a href="https://cat2151.github.io/tonejs-mml-to-json/index.html"><img src="https://img.shields.io/badge/ðŸš€-Live%20Demo-brightgreen.svg" alt="Demo"></a>
</p>

## Quick Links
| Item | Link |
|------|--------|
| ðŸŽµ Demo | https://cat2151.github.io/tonejs-mml-to-json/index.html |
| ðŸ“– Project Overview | [generated-docs/project-overview.md](generated-docs/project-overview.md) |
| ðŸ“– Call Graph | [generated-docs/callgraph-enhanced.html](https://cat2151.github.io/tonejs-mml-to-json/generated-docs/callgraph-enhanced.html) |
| ðŸ“Š Development Status | [generated-docs/development-status.md](generated-docs/development-status.md) |

# Summary in 3 Lines
- Converts music written in MML (Music Macro Language) into a JSON format playable in a browser.
- Allows you to create music with simple text and play it on a website.
- This tool specializes in music conversion; actual playback is handled by a separate project (``tonejs-json-sequencer``).

# Notes
- What are the benefits of writing music in MML (Music Macro Language)?
  - **Conciseness and Portability**: Text-based, lightweight, and platform-independent for the web.
  - **Programmer-friendly**: Code-like notation, easy Git management, and generation.
  - **Web Development Compatibility**: Direct playback in browsers, real-time editing, and lightweight delivery.
  - **Low Learning Curve**: Simple grammar, allows for progressive learning.
  - **Modular Design**: Conversion and playback are separated, allowing independent evolution of each.
  - **Fosters an Ecosystem**: Highly reusable, easy to share and accumulate knowledge.
  - **Adaptability to Dialects**: Assumes that system-specific MML dialects can be easily created and adapted using PEG for simple conversions.

- Why are tonejs-json-sequencer and tonejs-mml-to-json separate projects?
  - **To prioritize development independence and speed.**
    - Allows focus on MML parser development.
    - Enables rapid evolution without being constrained by dependencies between parser and playback functionalities.
  - For more details, please also refer to [tonejs-json-sequencer](https://github.com/cat2151/tonejs-json-sequencer).

# Future Considerations
## Regarding Rust Implementation
- **Rust + WASM implementation is now the primary implementation.**
  - As of issue #26, the TypeScript and Rust implementations have been consolidated.
  - All code (including tests) now uses the Rust WASM implementation.
  - Available as a Rust library crate.
  - Works in browsers via WASM compilation.
  - TypeScript wrappers provide API compatibility.
  - See [rust/README.md](rust/README.md) for details.
  - See [CONSOLIDATION.md](CONSOLIDATION.md) for consolidation details.

## Architecture
- **mml2ast**: A parser that converts MML strings into an AST.
- **ast**: The data structure for the AST (Abstract Syntax Tree).
- **ast2json**: Converts the AST into Tone.js-compatible JSON.

## Input/Output Definition
- *Illustrative examples to visualize the concept
- Input Example
  - ``o4 l16 e``
- Intermediate Format Example
  - *Designed as loosely coupled, thin layers to facilitate changes.
  - json (AST)
  - json (Pre-processed)
    - What is "processing"?
      - Node ID numbering, etc.
- Output Example
  - json (Post-processed)
    - Format recognized by tonejs-json-sequencer.
    - Details omitted; TDD test cases serve as the definitive specification.

## TDD Approach
- The test targets are mml2ast, ast2ast, and ast2json, individually.
  - Refer to TDD for mml2abc / chord2mml.
- I recall using Vitest for TDD in this project.
  - I plan to organize the test procedures later.

*This README.md is automatically generated by GitHub Actions using Gemini's translation of README.ja.md.